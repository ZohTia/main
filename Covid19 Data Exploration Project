--Covid 19 Data Exploration Project

--Skills used: Joins, CTE's, Temp Tables, Windows Functions, Aggregate Functions, Creating Views, Converting Data Types

SELECT *
FROM COVIDDEATHS$
ORDER BY 3,4


-- Select Data that we are going to be using in COVIDDEATHS$

SELECT LOCATION, DATE, NEW_CASES, TOTAL_DEATHS, POPULATION
FROM COVIDDEATHS$
ORDER BY 1,2

-- Death percentage in the Cote d'Ivoire

SELECT Location, Date, Population, Total_Cases, ROUND ((Total_Deaths/Total_Cases) * 100, 2) as DeathPercentage
FROM COVIDDEATHS$
WHERE Location like '%Cote%'


-- Countries with Highest Infection Rate compared to Population

SELECT Location, Population, MAX(Total_Cases) as HighestInfectionCount, MAX(Total_Cases/Population) * 100 as PercentPopulationInfected
FROM COVIDDEATHS$
GROUP BY Location, Population
ORDER BY PercentPopulationInfected desc;

-- Countries with Highest Death Count per Population

SELECT Location, MAX(cast(Total_Deaths as bigint)) as DeathCount
FROM COVIDDEATHS$
WHERE Continent is not null
GROUP BY Location
ORDER BY DeathCount desc

-- Global Number

SELECT SUM(cast(new_cases as bigint)) as TotalCases , SUM(cast(new_deaths as bigint)) as TotalDeaths, ROUND (SUM(cast(new_deaths as bigint))/SUM(New_Cases)*100,2) as DeathPercentage
FROM COVIDDEATHS$
WHERE Continent is not null

-- Join COVIDDEATHS$ to COVIDVACCINATION$

SELECT *		
FROM COVIDDEATHS$ JOIN COVIDVACCINATION$ 
	ON COVIDDEATHS$.Location = COVIDVACCINATION$.Location
	AND COVIDDEATHS$.Date = COVIDVACCINATION$.Date
